# Mini-XDR Azure Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         AZURE SUBSCRIPTION                                   â”‚
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    RESOURCE GROUP: mini-xdr-prod-rg                   â”‚  â”‚
â”‚  â”‚                                                                        â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚  â”‚
â”‚  â”‚  â”‚              VIRTUAL NETWORK (10.0.0.0/16)                   â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                               â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚      AKS SUBNET (10.0.1.0/24)                       â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                      â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  MINI-XDR AKS CLUSTER            â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ 3 Nodes (Standard_D4s_v3)     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â€¢ Auto-scale: 2-5 nodes         â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                   â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Backend Pods (Ã—3)       â”‚     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ Python/FastAPI        â”‚     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ ML Detection Engine   â”‚     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ 9 AI Agents           â”‚     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚                                   â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ Frontend Pods (Ã—3)      â”‚     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ Next.js 15            â”‚     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ React 19              â”‚     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ 3D Visualizations     â”‚     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                               â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚      SERVICES SUBNET (10.0.2.0/24)                  â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                      â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ PostgreSQL       â”‚  â”‚ Azure Cache         â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Flexible Server  â”‚  â”‚ for Redis           â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ Zone-redundant â”‚  â”‚ â€¢ Standard C1       â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ Private DNS    â”‚  â”‚ â€¢ Non-SSL disabled  â”‚     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                               â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚      APP GATEWAY SUBNET (10.0.3.0/24)               â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                      â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ APPLICATION GATEWAY (WAF)            â”‚           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ Standard v2                        â”‚           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ OWASP 3.2 ruleset                 â”‚           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ IP whitelist: YOUR_IP/32          â”‚           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                               â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚      CORPORATE NETWORK SUBNET (10.0.10.0/24)        â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                      â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Domain          â”‚  ğŸ”’ Private Subnet             â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Controller      â”‚  ğŸ”’ No Public IPs              â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Windows 2022    â”‚  ğŸ”’ Access via Bastion         â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ (mini-corp-dc01)â”‚                                â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                      â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Windows  â”‚  â”‚ Windows  â”‚  â”‚ Windows  â”‚          â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ WS01     â”‚  â”‚ WS02     â”‚  â”‚ WS03     â”‚          â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Win11 Proâ”‚  â”‚ Win11 Proâ”‚  â”‚ Win11 Proâ”‚          â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                      â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Linux    â”‚  â”‚ Linux    â”‚                        â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ SRV01    â”‚  â”‚ SRV02    â”‚                        â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ Ubuntu   â”‚  â”‚ Ubuntu   â”‚                        â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚                                                               â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚      BASTION SUBNET (10.0.255.0/24)                 â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚                                                      â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ AZURE BASTION                        â”‚           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ Secure RDP/SSH access              â”‚           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ No public IPs needed on VMs        â”‚           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â”‚ â€¢ Browser-based connection           â”‚           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚    â”‚    â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚  â”‚
â”‚  â”‚                                                                     â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚  SECURITY & MANAGEMENT                                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                             â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ Azure Containerâ”‚  â”‚ Azure Key Vault  â”‚                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ Registry (ACR) â”‚  â”‚ â€¢ Secrets        â”‚                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ Private      â”‚  â”‚ â€¢ Passwords      â”‚                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ Standard SKU â”‚  â”‚ â€¢ Connection str â”‚                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                             â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ Log Analytics  â”‚  â”‚ Managed          â”‚                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ Workspace      â”‚  â”‚ Identities       â”‚                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ AKS logs     â”‚  â”‚ â€¢ AKS identity   â”‚                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ â€¢ VM logs      â”‚  â”‚ â€¢ No credentials â”‚                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                     â”‚
                                     â”‚ HTTPS (YOUR_IP/32 only)
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚   YOUR LAPTOP  â”‚
                            â”‚                â”‚
                            â”‚  â€¢ Browser     â”‚
                            â”‚  â€¢ kubectl     â”‚
                            â”‚  â€¢ Azure CLI   â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow

### 1. User Access Flow
```
Your Browser â†’ Application Gateway (WAF) â†’ AKS Ingress â†’ Frontend Pods â†’ Backend API
```

### 2. Agent Communication Flow
```
Windows/Linux VMs â†’ Mini-XDR Agents â†’ Backend API â†’ PostgreSQL (events)
                                     â†’ Redis (cache)
                                     â†’ ML Detection Engine
```

### 3. Detection & Response Flow
```
Event Ingestion â†’ Feature Extraction â†’ ML Models (99%+ accuracy)
                â†’ Threat Detection (13 classes)
                â†’ Agent Actions (IAM/EDR/DLP)
                â†’ Audit Log (rollback support)
```

### 4. Attack Simulation Flow
```
Bastion â†’ Mini Corp VMs â†’ Generate Attack Traffic
                        â†’ Mini-XDR Detects
                        â†’ Agents Respond
                        â†’ Dashboard Shows Results
```

## Security Boundaries

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ INTERNET                                                 â”‚
â”‚   â”‚                                                      â”‚
â”‚   â”‚ YOUR_IP/32 ONLY                                     â”‚
â”‚   â–¼                                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚ â”‚ Application Gateway (WAF)       â”‚                      â”‚
â”‚ â”‚ â€¢ OWASP 3.2 Protection         â”‚                      â”‚
â”‚ â”‚ â€¢ IP Whitelisting              â”‚                      â”‚
â”‚ â”‚ â€¢ TLS 1.2+                     â”‚                      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â”‚ TLS
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AZURE PRIVATE NETWORK                                    â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ AKS Cluster          â”‚    â”‚ Managed Services     â”‚   â”‚
â”‚ â”‚ â€¢ Private Subnet     â”‚â—„â”€â”€â”€â”¤ â€¢ PostgreSQL         â”‚   â”‚
â”‚ â”‚ â€¢ NSG Rules          â”‚    â”‚ â€¢ Redis              â”‚   â”‚
â”‚ â”‚ â€¢ Azure AD RBAC      â”‚    â”‚ â€¢ Private Endpoints  â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ Mini Corporate Network (ISOLATED)                 â”‚   â”‚
â”‚ â”‚ â€¢ No Internet Access                              â”‚   â”‚
â”‚ â”‚ â€¢ Internal Communication Only                     â”‚   â”‚
â”‚ â”‚ â€¢ Access via Bastion Only                         â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚ â”‚ Key Vault            â”‚                               â”‚
â”‚ â”‚ â€¢ All Secrets        â”‚                               â”‚
â”‚ â”‚ â€¢ Access Policies    â”‚                               â”‚
â”‚ â”‚ â€¢ Soft Delete        â”‚                               â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Cost Allocation

```
                    Monthly Azure Cost: $800-1,400
                                â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                   â”‚                   â”‚
      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
      â”‚    AKS    â”‚      â”‚  Database â”‚     â”‚     VMs     â”‚
      â”‚ $250-400  â”‚      â”‚  $100-200 â”‚     â”‚  $260-520   â”‚
      â”‚  (31-36%) â”‚      â”‚  (13-14%) â”‚     â”‚  (32-37%)   â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                   â”‚                   â”‚
     3 nodes D4s_v3      PostgreSQL+Redis    1 DC + 3 Win
     Auto-scale 2-5      Zone-redundant      + 2 Linux
     
      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”
      â”‚  App GW   â”‚      â”‚   Other   â”‚
      â”‚ $150-200  â”‚      â”‚  $50-100  â”‚
      â”‚  (19-14%) â”‚      â”‚   (6-7%)  â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      WAF Standard v2    ACR, Storage,
      + SSL/TLS          Networking
```

## Deployment Timeline

```
T+0min    â”€â”¬â”€ Prerequisites Check (5 min)
           â”‚   âœ“ Azure CLI, Terraform, Docker, kubectl
           â”‚
T+5min    â”€â”¼â”€ Terraform Infrastructure (45 min)
           â”‚   âœ“ VNet, Subnets, NSGs
           â”‚   âœ“ AKS Cluster (3 nodes)
           â”‚   âœ“ PostgreSQL + Redis
           â”‚   âœ“ 6 VMs (1 DC + 3 Win + 2 Linux)
           â”‚   âœ“ Key Vault, ACR, App Gateway
           â”‚
T+50min   â”€â”¼â”€ Docker Image Build & Push (10 min)
           â”‚   âœ“ Backend image
           â”‚   âœ“ Frontend image
           â”‚   âœ“ Agent image
           â”‚
T+60min   â”€â”¼â”€ Kubernetes Deployment (5 min)
           â”‚   âœ“ Namespace, ConfigMap, Secrets
           â”‚   âœ“ Backend pods (Ã—3)
           â”‚   âœ“ Frontend pods (Ã—3)
           â”‚
T+65min   â”€â”¼â”€ Mini Corporate Network Setup (15 min)
           â”‚   âœ“ Promote DC
           â”‚   âœ“ Create OUs, Groups, Users
           â”‚   âœ“ Configure DNS
           â”‚
T+80min   â”€â”¼â”€ Verification & Summary (10 min)
           â”‚   âœ“ Check pod status
           â”‚   âœ“ Display access info
           â”‚   âœ“ Provide credentials
           â”‚
T+90min   â”€â”´â”€ DEPLOYMENT COMPLETE âœ“
```

---

**Ready to deploy!** ğŸš€

```bash
cd .
./ops/azure/scripts/deploy-all.sh
```

