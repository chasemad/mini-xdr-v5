[SERVICE]
    Flush         5
    Log_Level     info
    Daemon        off
    Parsers_File  parsers.conf
    HTTP_Server   On
    HTTP_Listen   0.0.0.0
    HTTP_Port     2020

# Cowrie SSH/Telnet Honeypot
[INPUT]
    Name              tail
    Path              /data/cowrie/log/cowrie.json
    Parser            json
    Tag               tpot.cowrie
    Refresh_Interval  5
    Read_from_Head    false
    Skip_Long_Lines   On
    Buffer_Chunk_Size 32k
    Buffer_Max_Size   64k

# Dionaea Multi-Protocol Honeypot  
[INPUT]
    Name              tail
    Path              /data/dionaea/log/dionaea.json
    Parser            json
    Tag               tpot.dionaea
    Refresh_Interval  5
    Read_from_Head    false
    Skip_Long_Lines   On

# Suricata Network IDS
[INPUT]
    Name              tail
    Path              /data/suricata/log/eve.json
    Parser            json
    Tag               tpot.suricata
    Refresh_Interval  5
    Read_from_Head    false
    Skip_Long_Lines   On

# Honeytrap Network Honeypot
[INPUT]
    Name              tail
    Path              /data/honeytrap/log/honeytrap.json
    Parser            json
    Tag               tpot.honeytrap
    Refresh_Interval  5
    Read_from_Head    false
    Skip_Long_Lines   On

# Elasticpot Elasticsearch Honeypot
[INPUT]
    Name              tail
    Path              /data/elasticpot/log/elasticpot.json
    Parser            json
    Tag               tpot.elasticpot
    Refresh_Interval  5
    Read_from_Head    false
    Skip_Long_Lines   On

# Output to Mini-XDR
[OUTPUT]
    Name  http
    Match tpot.*
    Host  10.0.0.222
    Port  8000
    URI   /ingest/multi
    Format json_stream
    Header Authorization Bearer $TPOT_API_KEY
    Header Content-Type application/json
    json_date_key timestamp
    json_date_format iso8601
    Retry_Limit 3
    tls Off
